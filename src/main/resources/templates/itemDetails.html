<!DOCTYPE html>
<html lang="en" layout:decorate="~{base}"
      xmlns:layout="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.com">
<head>
    <meta charset="UTF-8">
    <title>Item Details</title>
    <script src="https://cdn.jsdelivr.net/npm/simple-jscalendar@1.4.3/source/jsCalendar.min.js"
            integrity="sha384-JqNLUzAxpw7zEu6rKS/TNPZ5ayCWPUY601zaig7cUEVfL+pBoLcDiIEkWHjl07Ot"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-jscalendar@1.4.3/source/jsCalendar.min.css"
          integrity="sha384-+OB2CadpqXIt7AheMhNaVI99xKH8j8b+bHC8P5m2tkpFopGBklD3IRvYjPekeWIJ" crossorigin="anonymous">
</head>
<body>
<div layout:fragment="content">
    <h1 th:text="${item?.name}"></h1>
    <br>
    <img th:src="@{${'/images/' + item?.imageFileName}}"/>
    <dl>
        <dt>Description:</dt>
        <dd th:text="|${item?.description}|"></dd>
        <dt>Cost</dt>
        <dt>Daily Rate:</dt>
        <dd th:text="${item?.price}"></dd>
        <dt>Bail:</dt>
        <dd th:text="${item?.bail}"></dd>
        <dt>Location:</dt>
        <dd th:text="${item?.location}"></dd>
        <dt>Supplier:</dt>
        <dd th:text="${item?.owner?.accountName}"></dd>
    </dl>
    <strong><p>Rating:</p></strong>
    <span th:text="|${item?.owner?.totalRatings()}|"></span>
    <span th:text="|(${item?.owner?.getRating()}|"></span> &#128077;)
    <br>
    <br>
    <a th:if="${ownItem} == false " class="btn btn-success"
       th:href="|/offer/request/${item?.id}|">Request loan</a>
    <a th:unless="${ownItem} == false " class="btn btn-primary"
       th:href="|/offer/show/${item.getId()}|">Show Requests</a>
    <a style="margin-left: 1em;" th:unless="${ownItem} == false " class="btn btn-warning"
       th:href="|/item/edit/${item?.Id}|">Edit Item</a>
    <br>
    <br>

    <div id="my-calendar"></div>

    <script th:inline="javascript">
        var calendar = document.getElementById("my-calendar");
        var myCalendar = jsCalendar.new({
            target: calendar,
            monthFormat: "month YYYY"
        });
    </script>

    <div th:each="contract : ${item.getChosenContracts(false)}">

        <script th:inline="javascript"
                th:with=
                        "start=${#temporals.format(contract.getStart(),'yyyy-MM-dd')},
                      end=${#temporals.format(contract.getExpectedEnd(),'yyyy-MM-dd')}">
            var start = new Date([[${start}]]);
            var end = new Date([[${end}]]);

            for (var date = start; date <= end; date.setDate(date.getDate() + 1)) {
                myCalendar.select([
                    date
                ]);
            }

        </script>
    </div>
</div>

</body>
</html>
